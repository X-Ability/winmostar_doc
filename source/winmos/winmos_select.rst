.. include:: ../common.rst

.. _select_top:

選択メニュー
============================================

原子・分子を選択する機能に関するメニューです。

.. include:: winmos_selection.rst

すべてをグループ選択
-------------------------------------
   全ての原子をグループ選択します。

グループ選択を解除
-------------------------------------
   グループ選択を解除します。

グループ選択の範囲を反転
-------------------------------------
   グループ選択されていない原子をグループ選択し、それまでグループ選択されていた原子のグループ選択は解除します。

.. _select_mole:

分子種によるグループ選択
-------------------------------------
   :guilabel:`Select by` ウィンドウの :guilabel:`Use List` タブが :guilabel:`Molecular Species` にチェックされた状態で開きます。 
   :guilabel:`Select by` ウィンドウ内のリストの各行をクリックすると、対応する分子種がグループ選択されます。

   .. note::
      タンパク質のpdbファイルから計算する際に本機能を使用するとタンパク・リガンド・結合水・緩衝剤などを抜き出すことができます。

分子によるグループ選択
-------------------------------------
   :guilabel:`Select by` ウィンドウの :guilabel:`Use List` タブが :guilabel:`Molecules` にチェックされた状態で開きます。 
   :guilabel:`Select by` ウィンドウ内のリストの各行をクリックすると、対応する分子がグループ選択されます。

元素によるグループ選択
-------------------------------------
   :guilabel:`Select by` ウィンドウの :guilabel:`Use List` タブが :guilabel:`Elements` にチェックされた状態で開きます。 
   :guilabel:`Select by` ウィンドウ内のリストの各行をクリックすると、対応する元素がグループ選択されます。

選択記述言語によるグループ選択
-------------------------------------
   :guilabel:`Select by` ウィンドウの :guilabel:`Use Selection Language` タブが開きます。 
   テキストボックスに選択記述言語で選択方法を記述した後に、 :guilabel:`Apply` ボタンをクリックすると、対応する原子がグループ選択されます。
   選択記述言語では以下の構文がサポートされています。
   
   .. list-table:: 基礎的な構文
   
      * - ``element C H``
        - 全ての炭素と水素原子を選択します
      * - ``index 1-3 6 8``
        - 1, 2, 3, 6, 8番目の原子を選択します。
      * - ``compid 1``
        - | CompIDが1の分子種を選択します。
          | CompIDと分子種の対応は :guilabel:`Apply` ボタン下のリストで確認できます。
      * - ``moleid 1-3``
        - | 1, 2, 3番目の分子を選択します。
          | どの分子が何個あるかは :guilabel:`Apply` ボタン下のリストで確認できます。
      * - ``site 1``
        - | 各分子の中の1番目の原子（サイト）を選択します。
          | 各分子に含まれる原子の個数は :guilabel:`Apply` ボタン下のリストで確認できます。
      * - ``charge 0.5``
        - | 電荷が0.5の原子を選択します。
          | ±0.1 %の許容誤差が設けられています。
      * - ``resname GLY``
        - 残基名がGLYの残基に含まれる原子を選択します。
      * - ``name CA``
        - 原子名がCAの原子を選択します。
        
   残基名、原子名はPDBまたはgro形式のファイルを開いた際に使用可能です。
   
   .. list-table:: 論理演算子を用いた複合的な構文
   
      * - ``(compid 1) and (site 1)``
        - CompIDが1の分子種で、かつ分子内の1番目のサイトを選択します。
      * - ``(current) and (element H)``
        - 現在グループ選択されている原子の中で水素原子だけを選択します。
      * - ``(resname GLY) and (not (element H))``
        - 残基名がGLYで、かつ水素以外の原子を選択します。
        
   ``and`` 、 ``not`` 以外に ``or`` と ``xor`` を使用可能です。
   これらの論理演算子を使用する際には上記の例のように丸括弧 ``()`` を使用してください。

.. _select_separate:

マーカーで分断される部分構造をグループ選択
----------------------------------------------------
   1番目と2番目のマーカーが付いた2個の原子の間で分断される部分構造をグループ選択されます。 詳細は :ref:`select_top` に画像付きで記載しています。

現在のグループに隣接する原子をグループ選択
----------------------------------------------------
   現在の選択グループに隣接する原子をグループ選択します。ここでは、全原子にボロノイ分割を適用した際に、同一のボロノイ境界を有する原子を、隣接する原子を定義しています。

現在のグループに隣接する分子をグループ選択
----------------------------------------------------
   現在の選択グループに隣接する分子をグループ選択します。ここでは、全原子にボロノイ分割を適用した際に、同一のボロノイ境界を有する原子を、隣接する原子を定義しています。

.. _select_register_selected_group:

グループを登録
----------------------------------------------------
   グループ選択されたグループに名前を付けて登録し、 :ref:`select_select_registered_group` から呼び出せるようにします。
   
.. _select_select_registered_group:

登録グループを選択
----------------------------------------------------
   :ref:`select_register_selected_group` で登録されたグループを呼び出します。LAMMPS実行時には、ここにリストアップされたグループがndxファイル内に出力されます。Winmostarを再起動した後も登録グループを引き継ぎたい場合は、 :ref:`select_export_group_ndx` を用いてndxファイルに書き出した後、 :ref:`select_import_group_ndx` を用いて読み込みます。

.. _select_import_group_ndx:

ndxファイルからグループを読み込み
----------------------------------------------------
   ndxファイルに出力されたグループを読み込み、 :ref:`select_select_registered_group` から呼び出せるようにします。

.. _select_export_group_ndx:

登録グループをndxファイルに書き出し
----------------------------------------------------
   :ref:`select_select_registered_group` に登録されたグループをndxファイルに出力します。

.. _select_add_group_ndx:

グループをndxファイルに追加
----------------------------------------------------
   グループ選択されたグループを、指定したndxファイルに追加します。

