.. include:: ../common.rst

.. _gui_top:

============================================
画面の説明・操作方法
============================================

.. _gui_main:

画面の説明
============================================

   Winmostarを起動して出現するウィンドウ（ **メインウィンドウ** と呼ぶ）は下図の様な構成となっています。

   メインウィンドウのタイトルには現在編集中のファイルの名前、使用中のWinmostarのライセンスとバージョンが表示されます。

   |main_window_JP|

   .. |main_window_JP| image:: main_window_jp.png

   ツールバー
      メインメニューの中でよく使われる機能をここでも選択することができます。ポインタを重ねるとそれぞれのボタンの役割を確認できます。また、以下の機能のみ特殊な動作をします。
      
      - 上部のツールバーの1行目中央の :guilabel:`ソルバを選択` プルダウンメニュー |solver| （出荷時は ``MOPAC`` が選ばれるが最後に使ったソルバが表示される）で選ばれているソルバに応じて、その横の :guilabel:`キーワード設定` 、 :guilabel:`実行` などのボタンの役割が変化します。
      - 上部のツールバーの2行目左端の :guilabel:`編集操作で適用される元素を選択` プルダウンメニュー |chg| で選ばれた元素に応じて、その横の :guilabel:`原子を追加` 、 :guilabel:`元素を変更` ボタンの挙動が変化します。
   分子表示エリア
      現在編集中の分子構造が表示されます。デフォルトでは炭素原子（緑色）と水素原子（黄色）が結合した構造が表示されます。 :menuselection:`表示 --> 表示項目 --> 分子情報` メニューにチェックがついている場合は、上部と下部には詳細な情報が表示されます。赤丸は **原子選択マーカー** を示します。 **グループ選択** された状態では、原子が青丸で囲まれます。 :menuselection:`表示 --> ラベル/電荷` メニューから各原子の横に表示される番号や電荷の値の種類を切り替えることができます。配色は :menuselection:`ツール --> 環境設定 --> 表示` から変更することができます。
   キーワード表示エリア
      各ソルバのキーワード設定ウィンドウで設定した内容が表示されます。デフォルトではMOPACの設定が表示されます。
   座標表示エリア
      分子表示エリアに表示されている分子構造の、各原子の座標が表示されます。上部のタブで表示および出力する際の形式を切り替えることができます。デフォルトでは :guilabel:`Z-Matrix` が選択されています。グループ選択されていない状態では、座標表示エリアで選ばれた行とマーカー（赤丸）が付いた原子は一致します。 :kbd:`Ctrl+左クリック` または :kbd:`Shift+左クリック` により複数行を選択することでグループ選択（青丸）することができます。表示されている内容の詳細はポインタを重ねることで確認することができます。
   座標入力エリア
      マーカー（赤丸）が付いた原子の座標（Z-MatrixまたはXYZ形式）と最適化フラグを入力することができます。
   第二キーワード表示エリア
      :guilabel:`キーワード表示エリア` と基本的には同じですが、ここに記入された内容は、ソルバの入力ファイルの中で座標の後ろに出現します。GAMESS、Quantum ESPRESSOなどの一部のソルバでのみ使われます。

.. _gui_mouse:

マウス操作
============================================

   メインウィンドウでは下表のようにマウスで操作することができます。
   分子・原子を選択する方法の詳細は :ref:`select_top` に記載しています。

.. list-table::
   :header-rows: 1
   :stub-columns: 1

   * - | 修飾
       | キー
     - | 左クリック
     - | 左ドラッグ
     - | 右クリック
     - | 右ドラッグ／
       | ホイール操作
   * - なし
     - マーカーを移動
     - 視点の回転
     - 原子を置換
     - 表示の拡大・縮小
   * - :kbd:`Shift`
     - | 分子単位でグループ選択
       | または解除
     - 視線の平行移動
     - 原子を削除
     - 
   * - :kbd:`Ctrl`
     - | 複数原子をグループ選択
       | または解除
     - 矩形でグループ選択
     - 
     - 


ただし、分子表示エリアの右端を左ドラッグすると、表示を拡大・縮小することができます。


ショートカットキー
============================================

   メインウィンドウでは下表のショートカットキーを使うことができます。
   下表に記載されている以外にも、メインメニューの各項目の横に記載されたショートカットキーも使用可能です。

   .. list-table:: 基礎的な操作

      * - 新規
        - :kbd:`Ctrl+N`
      * - 開く
        - :kbd:`Ctrl+O`
      * - 上書き保存
        - :kbd:`Ctrl+S`
      * - 名前を付けて保存
        - :kbd:`Shift+Ctrl+S`
      * - 元に戻す
        - :kbd:`Ctrl+Z`
      * - やり直し
        - :kbd:`Ctrl+Y`
      * - グループを切り取り
        - :kbd:`Ctrl+X`
      * - グループをコピー
        - :kbd:`Ctrl+C`
      * - グループを貼り付け
        - :kbd:`Ctrl+V`
      * - ヘルプ
        - :kbd:`F1`

   .. list-table:: 分子構造の構築

      * - フラグメントで置換
        - :kbd:`F6`
      * - 原子を追加（座標を指定）
        - :kbd:`F4`
      * - 原子を削除
        - :kbd:`Shift+F4`
      * - 結合を付加/変更
        - :kbd:`F7`
      * - 結合を削除
        - :kbd:`F8`
      * - 原子を移動（並進移動）
        - :kbd:`F5`
      * - 元素を変更
        - :kbd:`Shift+F5`
      * - 水素を付加（すべての原子に付加）
        - :kbd:`Ctrl+H`
      * - グループを削除
        - :kbd:`Ctrl+D`
      * - 環構築
        - :kbd:`F9`

   .. list-table:: 分子構造の微調整

      * - 簡易構造最適化
        - :kbd:`Ctrl+G`
      * - グループを移動
        - :kbd:`Ctrl+M`
      * - グループを軸回転（選択2原子）
        - :kbd:`Ctrl+R`
      * - グループを軸回転（選択3原子）
        - :kbd:`Ctrl+A`
      * - グループを固定/固定解除
        - :kbd:`Ctrl+I`
      * - 結合長を自動調整
        - :kbd:`Ctrl+J`
      * - グループを回転（マウス操作）
        - :kbd:`Ctrl+F`
      * - グループを簡易構造最適化
        - :kbd:`Ctrl+L`

   .. list-table:: 表示関連の操作

      * - 表示の拡大
        - :kbd:`F3`
      * - 表示の縮小
        - :kbd:`F2`
      * - 表示をウィンドウに合わせる
        - :kbd:`Ctrl+4`
      * - 表示方向を変更
        - :kbd:`Ctrl+1, 2, 3`
      * - キーワード＆座標表示エリアの表示/非表示
        - :kbd:`F10`
      * - 分子表示エリアを画像として保存
        - :kbd:`Ctrl+Alt+I`
      * - 分子表示エリアを画像としてコピー
        - :kbd:`Ctrl+Alt+C`


